
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>windows下本地jekyll博客搭建手记</title>
    
    <meta name="author" content="柳裟">
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

      <link href="/assets/themes/twitter/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
      <link href="/assets/themes/twitter/stylesheets/gfm.css" media="screen, projection" rel="stylesheet" type="text/css">
      <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
      <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
      <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
      <![endif]-->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>

    <!-- start -->
    <div class="container">
        <div class="left-col">
            <div class="intrude-less">
                <header id="header" class="inner">
                    <div class="profilepic">
                        <img src='https://0.gravatar.com/avatar/372a13c579567ea98cafb3030289b63d?d=https%3A%2F%2Fidenticons.github.com%2Fffce3aba86b100da21f2295272398204.png&s=160' alt='Profile Picture' style='width: 160px;'>
                    </div>
                    <h1><a href="/">将材柳裟</a></h1>
                    <p class="subtitle"></p>
                    <nav id="main-nav">
                        <ul class="main">
                            <li><a href="/">博客</a></li>
                            <li><a href="/archive.html">文章列表</a></li>
                            <li><a href="/lab.html">实验室</a></li>
                        </ul>

                        <section class="aboutme">
                            <p>
                                Hi，我是柳裟，我目前在杭州，主要做前端开发的工作，兴趣于Web开发技术，这是我的博客，所记载偏技术，但可灵感可生活，喜欢和聪明的人打交道。
                            </p>
                        </section>
                    </nav>
                    <nav id="sub-nav">
                        <div class="social">
                            <a class="twitter" href="" title="暂时没有">Twitter</a>
                            <a class="github" href="https://github.com/superRaytin" title="GitHub">GitHub</a>
                            <a class="rss" href="/rss.xml" title="RSS">RSS</a>
                        </div>
                    </nav>
                </header>
            </div>
        </div>

        <div class="mid-col">
            <div class="mid-col-container">
                <div id="content" class="inner">
                        
<article class="post">
    <div class="meta">
        <div class="date">
            <time datetime='' data-updated="true" itemprop="datePublished">2013-09-07</time>
        </div>
        
        <div class="tags">
            
            


  
     
    	<a class="category" href="/tags.html#jekyll-ref">jekyll</a>&nbsp;
    
  



        </div>
        
    </div>
    <h1 class="title">windows下本地jekyll博客搭建手记</h1>
    <div class="entry markdown-body">
        <h3>前言</h3>

<p>准备把博客从wordpress搬到github，jekyll成为我的首选，这里主要介绍windows下本地搭建的步骤。之前曾经照着网上的介绍，一直没有成功，发现了不少问题，今天翻了诸多资料，也算是找到了一种可行
的方法，暂且放下网上教程们中要求的ruby，devkit版本，今天发现直接全部用最新的版本，也是可以的。</p>

<h3>安装Ruby环境和DevKit</h3>

<p>直接到 <a href="http://rubyinstaller.org/downloads/">rubyInstaller</a> 官网下载，目前最新的版本分别是 <code>Ruby 2.0.0-p247 (x64)</code> 和 <code>DevKit-mingw64-64-4.7.2-20130224-1432-sfx.exe</code> ，我的系统是64位，32位的话选择对应版本，
先安装Ruby环境，注意，必须先安装Ruby环境，为免混乱，可以解压至 <code>C:\Ruby</code> ,ruby安装成功之后安装DevKit，同样解压至 <code>C:\DevKit</code> 。</p>

<h3>配置</h3>

<p>a.打开CMD，运行以下命令：</p>

<pre><code>cd C:\DevKit

ruby dk.rb init

ruby dk.rb install
</code></pre>

<p>b.完成之后安装jekyll：</p>

<pre><code>gem install jekyll
</code></pre>

<p>可以用 <code>jekyll --version</code> 来检查是否安装成功</p>

<p>c.安装rdiscount，这个是用来解析Markdown标记的解析包。</p>

<pre><code>gem install rdiscount
</code></pre>

<h3>运行</h3>

<p>cd 到工程目录，目前网上大部分教程说的启动服务命令 <code>jekyll --serve</code> 都已过时，正确的应该是：</p>

<pre><code>jekyll serve
</code></pre>

<h3>中文支持异常情况</h3>

<p>你可能会遇到下面这种情况：</p>

<pre><code>D:\WebstormProjects\superraytin.github.com&gt;jekyll serve
Configuration file: D:/WebstormProjects/superraytin.github.com/_config.yml
       Deprecation: Auto-regeneration can no longer be set from your configurati
on file(s). Use the --watch/-w command-line option instead.
            Source: D:/WebstormProjects/superraytin.github.com
       Destination: D:/WebstormProjects/superraytin.github.com/_site
      Generating... Error reading file D:/WebstormProjects/superraytin.github.co
m/_posts/life/2013-05-23-i-am-a-test.md: invalid byte sequence in GBK
error: invalid byte sequence in GBK. Use --trace to view backtrace
</code></pre>

<p>或者下面这种情况</p>

<pre><code>D:\WebstormProjects\superraytin.github.com&gt;jekyll serve
Configuration file: D:/WebstormProjects/superraytin.github.com/_config.yml
       Deprecation: Auto-regeneration can no longer be set from your configurati
on file(s). Use the --watch/-w command-line option instead.
            Source: D:/WebstormProjects/superraytin.github.com
       Destination: D:/WebstormProjects/superraytin.github.com/_site
      Generating...   Liquid Exception: invalid byte sequence in GBK in _posts/s
kill/2011-12-29-jekyll-introduction.md
error: invalid byte sequence in GBK. Use --trace to view backtrace
</code></pre>

<h3>目前网上流传的一些解决办法</h3>

<p>1.<a href="http://yanping.me/cn/blog/2012/10/09/chinese-charset-problems-with-jekyll/">http://yanping.me/cn/blog/2012/10/09/chinese-charset-problems-with-jekyll/</a> 这篇文章给出的解决办法：
修改bash的字符集：在C:\Documents and Settings\用户名下，找到文件.bash_profile，后面加两行:</p>

<blockquote><p>set LC_ALL=en_US.UTF-8</p>

<p>set LANG=en_US.UTF-8</p></blockquote>

<p><strong>这种方法经过测试并不能解决问题</strong>。</p>

<p>2.<a href="http://www.dewen.org/q/5893">http://www.dewen.org/q/5893</a> 给出的解决办法：</p>

<p>a: 在文件头加上</p>

<pre><code># -*- coding:utf-8 -*-
</code></pre>

<p>指定运行环境的编码</p>

<pre><code>ruby --encoding=utf-8
</code></pre>

<p>b: 运行</p>

<pre><code>chcp 65001
</code></pre>

<p><strong>前面一种直接无效，后面一种可以起到短暂的效果，但是会有部分功能失效的问题</strong>，并且文章打开丢失了模板的头尾，只剩下乱码的文章主体部分。</p>

<h3>终极解决办法</h3>

<p>解决第一种错误——打开路径 <code>C:\Ruby200-x64\lib\ruby\gems\2.0.0\gems\jekyll-1.2.0\lib\jekyll</code>，打开 <code>convertible.rb</code></p>

<p>找到：</p>

<pre><code>self.content = File.read(File.join(base, name))
</code></pre>

<p>替换成：</p>

<pre><code>self.content = File.read(File.join(base, name), :encoding =&gt; "utf-8")
</code></pre>

<p>解决第二种错误——打开路径 <code>C:\Ruby200-x64\lib\ruby\gems\2.0.0\gems\jekyll-1.2.0\lib\jekyll\tags</code>，打开 <code>include.rb</code></p>

<p>找到：</p>

<pre><code>source = File.read(File.join(includes_dir, @file))
</code></pre>

<p>替换成：</p>

<pre><code>source = File.read(File.join(includes_dir, @file), :encoding =&gt; "utf-8")
</code></pre>

<p>重启jekyll服务，编译成功。</p>

<h3>markdown解释中文列表的问题</h3>

<p>jekyll默认的markdown解释引擎是maruku，在解释列表的时候，列表中有英文字符正常，否则会不正常，这种情况需要把解释引擎切换为rdiscount，
具体方法是打开 <code>_config_yml</code> 文件，在 <code>pygments:true</code> 下面添加一行</p>

<pre><code>markdown: rdiscount
</code></pre>

<h3>参考资料</h3>

<p><a href="http://log.medcl.net/item/2012/04/jekyll-encounter-encoding-problems/">http://log.medcl.net/item/2012/04/jekyll-encounter-encoding-problems/</a></p>

<p><a href="http://www.cnblogs.com/purediy/archive/2013/03/07/2948892.html">http://www.cnblogs.com/purediy/archive/2013/03/07/2948892.html</a></p>

<p><a href="http://cloudaice.com/markdown-list-chinese-problem/">http://cloudaice.com/markdown-list-chinese-problem/</a></p>

<h3>其他</h3>

<p>jekyll环境搭好之后，每次启动服务都需要cd到工程目录，然后运行命令 <code>jekyll serve</code>。</p>

<p>是不是觉得有点繁琐呢？</p>

<p>反正我是觉得很烦，这里写了个短小的批处理文件，可以当作是一键启动服务的开关，打开记事本，将下面的命令行拖到里面保存为 <code>.bat</code> 文件，放到桌面上，以后双击即可启动服务。</p>

<pre><code>@echo
cd D:\WebstormProjects\jekyllBlog
D:
jekyll serve
pause
</code></pre>

<p>第二行填写工程目录，第三行对应第二行的盘符——为什么这么做呢，因为直接 cd路径之后，必须要再运行相应的盘符才能到达工程目录，不信你可以试试。</p>

<p>批处理文件执行效果：</p>

<p><img class="lazy" src="/assets/posts/images/grey.gif" data-original="/assets/posts/images/jekyll-local-1.png"></p>

    </div>
</article>

<nav id="pagenavi">
    <a href="/skill/2014/03/20/mongodb-export-import" class="next">Next</a>
    <div class="center"><a href="/archive.html">Blog Archives</a></div>
</nav>

<!-- Duoshuo Comment BEGIN -->
<a name="ds_thread"></a>
<div class="ds-thread"></div>
<script type="text/javascript">
    var duoshuoQuery = {short_name:"raytinblog"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = 'http://static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0]
                || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
</script>
<!-- Duoshuo Comment END -->

<!--
<script type="text/javascript" charset="utf-8">
    var disqus_url = "http://superraytin.github.com/skill/2013/09/07/jekyll-local-structures-notes";
</script>

<!--
<p>
    <span class="showComment" id="J-showComment">comments ↓</span>
</p>
<div id="disqus_thread" class="height0"></div>
-->
<!--
<div id="disqus_thread" class="mt20"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'raytinspace'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
-->

                    <!--
                    <nav id="pagenavi">
                        <a href="/blog/page/2/" class="next">Next</a>
                        <div class="center"><a href="/blog/archives">Blog Archives</a></div>
                    </nav>
                    -->
                </div>
            </div>
            <footer id="footer" class="inner">
                Copyright &copy; 2013 superRaytin
                Powered by <a href="http://jekyllbootstrap.com">Jekyll</a>
                Design from <a href="http://shashankmehta.in/archive/2012/greyshade.html">Greyshade</a>
            </footer>
            <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
            <script src="/assets/themes/twitter/javascripts/jquery.lazyload.min.js"></script>
            <script src="/assets/themes/twitter/javascripts/common.js"></script>
        </div>
    </div>
    <!-- end -->
    
  </body>
</html>
